var e,t,s,l,a,i;import{o as r,c as n,w as o,a as u,t as c,n as d,b as h,d as p,i as f,r as m,e as _,f as y,g as v,F as g,h as b,j as w,S as k,u as x,p as $,k as S,l as C,Z as I,m as B,s as T,q as N,v as R,x as j}from"./index-MW_-gdzf.js";import{m as L,a as O}from"./mixin.DTr63w4a.js";import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as W,o as D}from"./uni-app.es.B2hRzsp_.js";import{_ as M}from"./uni-dateformat.CoQr-v7f.js";import{g as z,a as A}from"./tools.DaQt4Fsp.js";const P={props:{isDot:{type:Boolean,default:!1},value:{type:[Number,String],default:""},show:{type:Boolean,default:!0},max:{type:[Number,String],default:999},type:{type:[String,void 0,null],default:"error"},showZero:{type:Boolean,default:!1},bgColor:{type:[String,null],default:null},color:{type:[String,null],default:null},shape:{type:[String,void 0,null],default:"circle"},numberType:{type:[String,void 0,null],default:"overflow"},offset:{type:Array,default:()=>[]},inverted:{type:Boolean,default:!1},absolute:{type:Boolean,default:!1},...null==(t=null==(e=uni.$uv)?void 0:e.props)?void 0:t.badge}};const Z=U({name:"uv-badge",mixins:[L,O,P],computed:{boxStyle:()=>({}),badgeStyle(){const e={};if(this.color&&(e.color=this.color),this.bgColor&&!this.inverted&&(e.backgroundColor=this.bgColor),this.absolute&&(e.position="absolute",this.offset.length)){const t=this.offset[0],s=this.offset[1]||t;e.top=this.$uv.addUnit(t),e.right=this.$uv.addUnit(s)}return e},showValue(){switch(this.numberType){case"overflow":return Number(this.value)>Number(this.max)?this.max+"+":this.value;case"ellipsis":return Number(this.value)>Number(this.max)?"...":this.value;case"limit":return Number(this.value)>999?Number(this.value)>=9999?Math.floor(this.value/1e4*100)/100+"w":Math.floor(this.value/1e3*100)/100+"k":this.value;default:return Number(this.value)}},propsType(){return this.type||"error"}}},[["render",function(e,t,s,l,a,i){const m=f;return e.show&&(0!==Number(e.value)||e.showZero||e.isDot)?(r(),n(m,{key:0,class:d([[e.isDot?"uv-badge--dot":"uv-badge--not-dot",e.inverted&&"uv-badge--inverted","horn"===e.shape&&"uv-badge--horn",`uv-badge--${i.propsType}${e.inverted?"--inverted":""}`],"uv-badge"]),style:h([e.$uv.addStyle(e.customStyle),i.badgeStyle])},{default:o((()=>[u(c(e.isDot?"":i.showValue),1)])),_:1},8,["class","style"])):p("",!0)}],["__scopeId","data-v-8c3e535e"]]);const V=U({name:"uv-tabs",emits:["click","change"],mixins:[L,O,{props:{duration:{type:Number,default:300},list:{type:Array,default:()=>[]},lineColor:{type:String,default:"#3c9cff"},activeStyle:{type:[String,Object],default:()=>({color:"#303133"})},inactiveStyle:{type:[String,Object],default:()=>({color:"#606266"})},lineWidth:{type:[String,Number],default:20},lineHeight:{type:[String,Number],default:3},lineBgSize:{type:String,default:"cover"},itemStyle:{type:[String,Object],default:()=>({height:"44px"})},scrollable:{type:Boolean,default:!0},current:{type:[Number,String],default:0},keyName:{type:String,default:"name"},...null==(l=null==(s=uni.$uv)?void 0:s.props)?void 0:l.tabs}}],data:()=>({firstTime:!0,scrollLeft:0,scrollViewWidth:0,lineOffsetLeft:0,tabsRect:{left:0},innerCurrent:0,moving:!1}),watch:{current:{immediate:!0,handler(e,t){e!==this.innerCurrent&&(this.innerCurrent=e,this.$nextTick((()=>{this.resize()})))}},list(){this.$nextTick((()=>{this.resize()}))}},computed:{textStyle(){return e=>{const t={},s=e==this.innerCurrent?this.$uv.addStyle(this.activeStyle):this.$uv.addStyle(this.inactiveStyle);return this.list[e].disabled&&(t.color="#c8c9cc"),this.$uv.deepMerge(s,t)}},propsBadge:()=>P},async mounted(){this.init()},methods:{setLineLeft(){const e=this.list[this.innerCurrent];if(!e)return;let t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0),s=this.$uv.getPx(this.lineWidth);this.$uv.test.number(this.lineWidth)&&this.$uv.unit&&(s=this.$uv.getPx(`${this.lineWidth}${this.$uv.unit}`)),this.lineOffsetLeft=t+(e.rect.width-s)/2,this.firstTime&&setTimeout((()=>{this.firstTime=!1}),20)},animation(e,t=0){},clickHandler(e,t){this.$emit("click",{...e,index:t}),e.disabled||(this.innerCurrent!=t&&this.$emit("change",{...e,index:t}),this.innerCurrent=t,this.$nextTick((()=>{this.resize()})))},init(){this.$uv.sleep().then((()=>{this.resize()}))},setScrollLeft(){const e=this.list[this.innerCurrent],t=this.list.slice(0,this.innerCurrent).reduce(((e,t)=>e+t.rect.width),0),s=this.$uv.sys().windowWidth;let l=t-(this.tabsRect.width-e.rect.width)/2-(s-this.tabsRect.right)/2+this.tabsRect.left/2;l=Math.min(l,this.scrollViewWidth-this.tabsRect.width),this.scrollLeft=Math.max(0,l)},resize(){0!==this.list.length&&Promise.all([this.getTabsRect(),this.getAllItemRect()]).then((([e,t=[]])=>{this.tabsRect=e,this.scrollViewWidth=0,t.map(((e,t)=>{this.scrollViewWidth+=e.width,this.list[t].rect=e})),this.setLineLeft(),this.setScrollLeft()}))},getTabsRect(){return new Promise((e=>{this.queryRect("uv-tabs__wrapper__scroll-view").then((t=>e(t)))}))},getAllItemRect(){return new Promise((e=>{const t=this.list.map(((e,t)=>this.queryRect(`uv-tabs__wrapper__nav__item-${t}`,!0)));Promise.all(t).then((t=>e(t)))}))},queryRect(e,t){return new Promise((t=>{this.$uvGetRect(`.${e}`).then((e=>{t(e)}))}))}}},[["render",function(e,t,s,l,a,i){const p=f,x=W(m("uv-badge"),Z),$=w,S=k;return r(),n($,{class:"uv-tabs",style:h([e.$uv.addStyle(e.customStyle)])},{default:o((()=>[_($,{class:"uv-tabs__wrapper"},{default:o((()=>[y(e.$slots,"left",{},void 0,!0),_($,{class:"uv-tabs__wrapper__scroll-view-wrapper"},{default:o((()=>[_(S,{"scroll-x":e.scrollable,"scroll-left":a.scrollLeft,"scroll-with-animation":"",class:"uv-tabs__wrapper__scroll-view","show-scrollbar":!1,ref:"uv-tabs__wrapper__scroll-view"},{default:o((()=>[_($,{class:"uv-tabs__wrapper__nav",ref:"uv-tabs__wrapper__nav",style:h({flex:e.scrollable?"":1})},{default:o((()=>[(r(!0),v(g,null,b(e.list,((t,s)=>(r(),n($,{class:d(["uv-tabs__wrapper__nav__item",[`uv-tabs__wrapper__nav__item-${s}`,t.disabled&&"uv-tabs__wrapper__nav__item--disabled"]]),key:s,onClick:e=>i.clickHandler(t,s),ref_for:!0,ref:`uv-tabs__wrapper__nav__item-${s}`,style:h([{flex:e.scrollable?"":1},e.$uv.addStyle(e.itemStyle)])},{default:o((()=>[_(p,{class:d([[t.disabled&&"uv-tabs__wrapper__nav__item__text--disabled"],"uv-tabs__wrapper__nav__item__text"]),style:h([i.textStyle(s)])},{default:o((()=>[u(c(t[e.keyName]),1)])),_:2},1032,["class","style"]),_(x,{show:!(!t.badge||!(t.badge.show||t.badge.isDot||t.badge.value)),isDot:t.badge&&t.badge.isDot||i.propsBadge.isDot,value:t.badge&&t.badge.value||i.propsBadge.value,max:t.badge&&t.badge.max||i.propsBadge.max,type:t.badge&&t.badge.type||i.propsBadge.type,showZero:t.badge&&t.badge.showZero||i.propsBadge.showZero,bgColor:t.badge&&t.badge.bgColor||i.propsBadge.bgColor,color:t.badge&&t.badge.color||i.propsBadge.color,shape:t.badge&&t.badge.shape||i.propsBadge.shape,numberType:t.badge&&t.badge.numberType||i.propsBadge.numberType,inverted:t.badge&&t.badge.inverted||i.propsBadge.inverted,customStyle:"margin-left: 4px;"},null,8,["show","isDot","value","max","type","showZero","bgColor","color","shape","numberType","inverted"])])),_:2},1032,["onClick","style","class"])))),128)),_($,{class:"uv-tabs__wrapper__nav__line",ref:"uv-tabs__wrapper__nav__line",style:h([{width:e.$uv.addUnit(e.lineWidth),transform:`translate(${a.lineOffsetLeft}px)`,transitionDuration:`${a.firstTime?0:e.duration}ms`,height:a.firstTime?0:e.$uv.addUnit(e.lineHeight),background:e.lineColor,backgroundSize:e.lineBgSize}])},null,8,["style"])])),_:1},8,["style"])])),_:1},8,["scroll-x","scroll-left"])])),_:1}),y(e.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["style"])}],["__scopeId","data-v-da7392b4"]]);const q=U({name:"uv-skeletons",mixins:[L,O],props:{loading:{type:Boolean,default:!0},skeleton:{type:Array,default:()=>[]},animate:{type:Boolean,default:!0},round:{type:Boolean,default:!1},...null==(i=null==(a=uni.$uv)?void 0:a.props)?void 0:i.skeleton},data:()=>({elements:[],opacity:.5,duration:600}),computed:{animateClass(){return this.animate?"uv-skeleton--animation":"uv-skeleton--static"},roundClass(){return this.round?"uv-skeleton--round":"uv-skeleton--radius"},style(e){return e=>this.$uv.deepMerge({},this.$uv.addStyle(e.style))}},created(){this.init()},methods:{init(){let e=[];if(!this.$uv.test.array(this.skeleton))return this.$uv.error("skeleton参数必须为数组形式，参考文档示例：");this.skeleton.forEach((t=>{const s=this.getElCounts(t);e=e.concat(s)})),this.elements=[...e]},getElCounts(e){let t=[],s=[];if(this.$uv.test.number(e))return t.push({type:"gap",height:e}),t;{const l=e.type?e.type:"line",a=e.num?e.num:1,i=e.style?e.style:{},r=this.$uv.test.array(i),n=e.gap?e.gap:"20rpx",o=e.children?e.children:[];for(let e=0;e<o.length;e++)s[e]={clas:o[e].type.indexOf("avatar")>-1||o[e].type.indexOf("custom")>-1?"":"uv-skeleton__group__sub",elements:this.getElCounts(o[e])};for(let e=0;e<a;e++)n&&e<a&&e>0&&t.push({type:"gap",height:n}),t.push({clas:`uv-skeleton__${l}`,type:l,style:r?i[e]:i,gap:n,children:s});return t}},createAnimation(e=1){if(!this.loading||!this.animate)return;let t=0;const s=this.$refs.skeleton;s.forEach((l=>{animation.transition(l,{styles:{opacity:e},duration:this.duration},(()=>{t++,t>=s.length&&setTimeout((()=>{this.createAnimation(e<1?1:this.opacity)}),200)}))}))}}},[["render",function(e,t,s,l,a,i){const u=w;return r(),n(u,{class:"uv-skeleton"},{default:o((()=>[s.loading?(r(),n(u,{key:0},{default:o((()=>[(r(!0),v(g,null,b(a.elements,((t,s)=>(r(),n(u,{key:s},{default:o((()=>["flex"==t.type?(r(),n(u,{key:0,class:"uv-skeleton__group",style:h([i.style(t)])},{default:o((()=>[(r(!0),v(g,null,b(t.children,((t,s)=>(r(),n(u,{class:d([t.clas]),style:h([i.style(t)]),key:s},{default:o((()=>[(r(!0),v(g,null,b(t.elements,((t,s)=>(r(),n(u,{key:s},{default:o((()=>["gap"==t.type?(r(),n(u,{key:0,style:h({height:e.$uv.addUnit(t.height,"rpx")})},null,8,["style"])):(r(),n(u,{key:1,class:d([t.clas,i.roundClass,i.animateClass]),style:h([i.style(t)]),ref_for:!0,ref:"skeleton"},null,8,["class","style"]))])),_:2},1024)))),128))])),_:2},1032,["class","style"])))),128))])),_:2},1032,["style"])):"custom"==t.type?(r(),n(u,{key:1,class:d([t.clas,i.animateClass]),style:h([i.style(t)]),ref_for:!0,ref:"skeleton"},null,8,["class","style"])):"gap"==t.type?(r(),n(u,{key:2,style:h({height:e.$uv.addUnit(t.height,"rpx")})},null,8,["style"])):(r(),n(u,{key:3,class:d([t.clas,i.roundClass,i.animateClass]),style:h([i.style(t)]),ref_for:!0,ref:"skeleton"},null,8,["class","style"]))])),_:2},1024)))),128))])),_:1})):(r(),n(u,{key:1},{default:o((()=>[y(e.$slots,"default",{},void 0,!0)])),_:3}))])),_:3})}],["__scopeId","data-v-cf4a5463"]]),E=U({__name:"blog-item",props:{articleItem:{type:Object,default:()=>({})}},setup(e){let t=e;function s(){S({url:"/pages/detail/detail?id="+t.articleItem._id})}return(l,a)=>{const i=C,h=w,y=W(m("uni-dateformat"),M),k=f;return r(),n(h,{class:"blogitem"},{default:o((()=>[_(h,{class:"head"},{default:o((()=>[_(h,{class:"userinfo"},{default:o((()=>[_(h,{class:"avatar"},{default:o((()=>[_(i,{src:x(z)(e.articleItem),mode:"aspectFill"},null,8,["src"])])),_:1}),_(h,{class:"name"},{default:o((()=>[u(c(x(A)(e.articleItem)),1)])),_:1}),_(h,{class:"time"},{default:o((()=>[_(y,{date:e.articleItem.publish_date,format:"MM月dd hh:mm",threshold:[6e4,2592e6]},null,8,["date"])])),_:1})])),_:1}),_(h,{class:"more"},{default:o((()=>[_(k,{class:"iconfont icon-ellipsis"})])),_:1})])),_:1}),_(h,{class:"body"},{default:o((()=>[_(h,{class:"title",onClick:s},{default:o((()=>[u(c(e.articleItem.title),1)])),_:1}),e.articleItem.description?(r(),n(h,{key:0,class:"text",onClick:s},{default:o((()=>[_(h,{class:"t"},{default:o((()=>[u(c(e.articleItem.description),1)])),_:1})])),_:1})):p("",!0),e.articleItem.picUrls.length?(r(),n(h,{key:1,class:"piclist"},{default:o((()=>[(r(!0),v(g,null,b(e.articleItem.picUrls,((s,l)=>(r(),n(h,{class:d(["pic",1==e.articleItem.picUrls.length?"only":""]),key:l},{default:o((()=>[_(i,{onClick:e=>function(e){$({urls:t.articleItem.picUrls,current:e})}(l),src:s,mode:"aspectFill"},null,8,["onClick","src"])])),_:2},1032,["class"])))),128))])),_:1})):p("",!0)])),_:1}),_(h,{class:"info"},{default:o((()=>[_(h,{class:"box"},{default:o((()=>[_(k,{class:"iconfont icon-a-27-liulan"}),_(k,null,{default:o((()=>[u(c(e.articleItem.view_count?e.articleItem.view_count:"抢首览"),1)])),_:1})])),_:1}),_(h,{class:"box"},{default:o((()=>[_(k,{class:"iconfont icon-a-5-xinxi"}),_(k,null,{default:o((()=>[u(c(e.articleItem.comment_count?e.articleItem.comment_count:"抢首评"),1)])),_:1})])),_:1}),_(h,{class:"box"},{default:o((()=>[_(k,{class:"iconfont icon-a-106-xihuan"}),_(k,null,{default:o((()=>[u(c(e.articleItem.like_count?e.articleItem.like_count:"抢首攒"),1)])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-a5b94b4a"]]),H=U({__name:"index",setup(e){const t=I.importObject("forumCloudObj",{customUI:!0});let s=B([{name:"最新",type:"publish_date"},{name:"热门",type:"view_count"}]),l=B([]),a=B(!1),i=[{type:"line",num:3,gap:"20rpx",style:["width: 200rpx;marginBottom: 50rpx;","height: 100rpx;","width: 500rpx;"]}];async function u(e="publish_date"){a.value=!0,l.value=[];let s=null;try{s=await t.getArticleList(e)}catch(i){T({title:"错误",content:i.errMsg,showCancel:!1})}l.value=s.data,a.value=!1}function c(e){console.log(e.type),u(e.type)}return D((async()=>{u()})),(e,t)=>{const u=W(m("uv-tabs"),V),d=w,h=W(m("uv-skeletons"),q),p=W(m("blog-item"),E),y=f,k=j;return r(),n(d,{class:"home"},{default:o((()=>[_(d,{class:"topnav"},{default:o((()=>[_(u,{list:x(s),activeStyle:{color:"#333",fontWeight:"bold",transform:"scale(1.08)"},inactiveStyle:{color:"#888",transform:"scale(1)"},onClick:c},null,8,["list","activeStyle","inactiveStyle"])])),_:1}),N(_(d,{class:"loadingState"},{default:o((()=>[_(h,{loading:x(a),skeleton:x(i)},null,8,["loading","skeleton"])])),_:1},512),[[R,x(a)]]),_(d,{class:"content"},{default:o((()=>[(r(!0),v(g,null,b(x(l),(e=>(r(),n(d,{class:"item"},{default:o((()=>[_(p,{articleItem:e},null,8,["articleItem"])])),_:2},1024)))),256))])),_:1}),_(k,{url:"/pages/edit/edit",class:"edit"},{default:o((()=>[_(y,{class:"iconfont icon-a-21-xiugai"})])),_:1})])),_:1})}}},[["__scopeId","data-v-5deb5326"]]);export{H as default};
