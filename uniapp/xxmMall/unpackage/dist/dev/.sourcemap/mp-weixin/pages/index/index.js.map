{"version":3,"file":"index.js","sources":["pages/index/index.vue","../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"home\">\r\n\t\t<!-- 顶部商店信息栏 -->\r\n\t\t<custom-topBar id=\"customTopBar\" :foldState=\"foldState\"></custom-topBar>\r\n\t\t<!-- 菜单和底部操作栏 -->\r\n\t\t<view class=\"wrapper\">\r\n\t\t\t<!-- 配送信息弹窗和订单弹窗 -->\r\n\t\t\t<view class=\"infoModel\">\r\n\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t免费配送\r\n\t\t\t\t</view>\r\n\t\t\t\t<navigator url=\"/pages/order/order\" class=\"right\">\r\n\t\t\t\t\t<uv-icon name=\"order\" color=\"#576b95\" size=\"22\"></uv-icon>\r\n\t\t\t\t\t我的订单\r\n\t\t\t\t</navigator>\r\n\t\t\t</view>\r\n\t\t\t<!-- 整体滑动区域 -->\r\n\t\t\t<view class=\"scrollLayout\">\r\n\t\t\t\t<!-- 左半边菜单 -->\r\n\t\t\t\t<view class=\"leftScroll\">\r\n\t\t\t\t\t<scroll-view :scroll-top=\"leftScrollValue\" scroll-y class=\"sContent\">\r\n\t\t\t\t\t\t<view class=\"navItem\" :class=\"index==navIdx?'active':''\" v-for=\"(i,index) in dataList\"\r\n\t\t\t\t\t\t\t:key=\"i.id\" @click=\"clickNav(index)\">{{i.name}}</view>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 右半边商品列表 -->\r\n\t\t\t\t<view class=\"rightScroll\">\r\n\t\t\t\t\t<navigator url=\"/pages/search/search\" class=\"searchView\">\r\n\t\t\t\t\t\t<uv-icon name=\"search\" size=\"22\" color=\"#576b95\"></uv-icon>\r\n\t\t\t\t\t\t<text>搜索</text>\r\n\t\t\t\t\t</navigator>\r\n\t\t\t\t\t<scroll-view @scroll=\"rightScrollEnt\" :scroll-top=\"rightScrollValue\" scroll-with-animation scroll-y\r\n\t\t\t\t\t\tclass=\"sContent\">\r\n\t\t\t\t\t\t<!-- 每一个模块 -->\r\n\t\t\t\t\t\t<view class=\"productView\" v-for=\"i in dataList\" :key=\"i.id\">\r\n\t\t\t\t\t\t\t<!-- 模块标题 -->\r\n\t\t\t\t\t\t\t<uv-sticky customNavHeight=\"0\" zIndex=\"2\">\r\n\t\t\t\t\t\t\t\t<view class=\"proTitle\">{{i.name}}</view>\r\n\t\t\t\t\t\t\t</uv-sticky>\r\n\t\t\t\t\t\t\t<!-- 模块里的items -->\r\n\t\t\t\t\t\t\t<view class=\"proContent\">\r\n\t\t\t\t\t\t\t\t<!-- 每一个item选项 -->\r\n\t\t\t\t\t\t\t\t<view class=\"proitem\" v-for=\"ii in i.children\" :key=\"ii.id\">\r\n\t\t\t\t\t\t\t\t\t<product-item :item=\"ii\"></product-item>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<!--  -->\r\n\t\t</view>\r\n\t\t<!-- 购物车 -->\r\n\t\t<car-layout v-if=\"carStore.buyNum>0\"></car-layout>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref\r\n\t} from 'vue';\r\n\timport {\r\n\t\tonReady\r\n\t} from '@dcloudio/uni-app'\r\n\timport useSystem from \"../../store/system.js\"\r\n\timport useCar from '../../store/car.js';\r\n\r\n\tconst systemStore = useSystem()\r\n\tconst carStore = useCar()\r\n\r\n\tlet navIdx = ref(0)\r\n\tlet rightScrollValue = ref(0)\r\n\tlet leftScrollValue = ref(0)\r\n\tlet leftHitArr = ref([])\r\n\tlet rightHitArr = ref([])\r\n\tlet foldState = ref(false) //顶部信息栏折叠状态\r\n\r\n\tlet dataList = ref([{\r\n\t\tid: 1,\r\n\t\tname: \"豆干制品\",\r\n\t\tchildren: [{\r\n\t\t\tid: 11,\r\n\t\t\tname: \"卫龙辣条\",\r\n\t\t\tprice: 10,\r\n\t\t\tbefore_price: 22,\r\n\t\t\tthumb: \"https://mp-c422c6b7-799d-4ff5-9531-5051a0481131.cdn.bspapp.com/cloudstorage/83562e26-cfac-4cec-8f51-9ae6986942af.jpg\",\r\n\t\t\tnumvalue: 0\r\n\t\t}, {\r\n\t\t\tid: 12,\r\n\t\t\tname: \"卫龙大面筋\",\r\n\t\t\tprice: 5,\r\n\t\t\tbefore_price: 12,\r\n\t\t\tthumb: \"https://mp-c422c6b7-799d-4ff5-9531-5051a0481131.cdn.bspapp.com/cloudstorage/30569d48-bb94-40de-8d2b-a3be99d710cd.jpg\",\r\n\t\t\tnumvalue: 0\r\n\t\t}]\r\n\t}, {\r\n\t\tid: 2,\r\n\t\tname: \"饼干糕点\",\r\n\t\tchildren: [{\r\n\t\t\tid: 21,\r\n\t\t\tname: \"丹麦曲奇\",\r\n\t\t\tprice: 25,\r\n\t\t\tbefore_price: 36,\r\n\t\t\tthumb: \"https://mp-3309c116-4743-47d6-9979-462d2edf878c.cdn.bspapp.com/cloudstorage/6758e11c-949b-48c5-ae69-ddad030c2f94.png\",\r\n\t\t\tnumvalue: 0\r\n\t\t}]\r\n\t}, {\r\n\t\tid: 3,\r\n\t\tname: \"酒水饮料\",\r\n\t\tchildren: [{\r\n\t\t\tid: 31,\r\n\t\t\tname: \"韩国烧酒\",\r\n\t\t\tprice: 18,\r\n\t\t\tbefore_price: 29,\r\n\t\t\tthumb: \"https://mp-3309c116-4743-47d6-9979-462d2edf878c.cdn.bspapp.com/cloudstorage/b1a12bee-0602-4cb5-927d-b2b246700e89.jpeg\",\r\n\t\t\tnumvalue: 0\r\n\t\t}]\r\n\t}])\r\n\r\n\r\n\t// 在页面渲染好后，获取右侧滚动条中每条内容的高度\r\n\tonReady(() => {\r\n\t\tgetHeightArr()\r\n\t})\r\n\r\n\t// 点击左侧菜单栏事件\r\n\tfunction clickNav(index) {\r\n\t\t// 防抖，防止来回点击\r\n\t\tif (navIdx.value == index) return\r\n\t\tlet timeout;\r\n\t\tif (timeout) {\r\n\t\t\tclearTimeout(timeout)\r\n\t\t}\r\n\r\n\t\ttimeout = setTimeout(() => {\r\n\t\t\t//设置导航栏选中\r\n\t\t\tnavIdx.value = index\r\n\t\t\t//设置右侧滚动条位置\r\n\t\t\trightScrollValue.value = rightHitArr.value[index]\r\n\t\t\t// 设置左侧滚动条位置(让选中的选项自动滚动到第一个)\r\n\t\t\tleftScrollValue.value = leftHitArr.value[index]\r\n\t\t}, 100)\r\n\r\n\r\n\t}\r\n\t//获取右侧滚动条内容的高度\r\n\tfunction getHeightArr() {\r\n\t\tlet selectQuery = uni.createSelectorQuery()\r\n\t\tlet customTopBarHeight = 0\r\n\r\n\t\t// 获取顶部自定义导航栏高度\r\n\t\tselectQuery.select(\"#customTopBar\").boundingClientRect(rect => {\r\n\t\t\tcustomTopBarHeight = rect.height\r\n\t\t}).exec()\r\n\r\n\t\t// 左侧滚动区域节点组\r\n\t\tselectQuery.selectAll(\".navItem\").boundingClientRect(rects => {\r\n\t\t\t// console.log(rects)\r\n\t\t\tleftHitArr.value = rects.map(item => {\r\n\t\t\t\treturn item.top - customTopBarHeight - 50 + 10\r\n\t\t\t})\r\n\t\t}).exec()\r\n\t\t// console.log(leftHitArr.value)\r\n\t\t// 右侧滚动区域节点组\r\n\t\tselectQuery.selectAll(\".productView\").boundingClientRect(rects => {\r\n\t\t\t// console.log(rects)\r\n\t\t\trightHitArr.value = rects.map(item => {\r\n\t\t\t\treturn item.top - customTopBarHeight - 50 + 10\r\n\t\t\t})\r\n\t\t}).exec()\r\n\t\t// console.log(rightHitArr.value)\r\n\t}\r\n\t// 右侧滚动条滚动事件\r\n\tfunction rightScrollEnt(e) {\r\n\t\t// 向上取整，避免H5页面滚动条误差\r\n\t\tlet scrollTop = Math.ceil(e.detail.scrollTop)\r\n\t\t// 判断目前的高度属于哪个模块的idx\r\n\t\tlet idx = rightHitArr.value.findIndex((item, index, arr) => {\r\n\t\t\treturn scrollTop >= item && scrollTop < arr[index + 1]\r\n\t\t})\r\n\t\tnavIdx.value = idx\r\n\t\tleftScrollValue.value = leftHitArr.value[idx]\r\n\t\t// 如果滚动高度大于某个值，就折叠顶部导航栏\r\n\t\tif (scrollTop > 400) {\r\n\t\t\tsystemStore.setFoldState(true)\r\n\t\t\t// foldState.value = true\r\n\t\t} else {\r\n\t\t\tsystemStore.setFoldState(false)\r\n\t\t\t// foldState.value = false\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.home {\r\n\t\theight: 100vh;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\r\n\t\t.wrapper {\r\n\t\t\tflex: 1;\r\n\t\t\tbackground: #fff;\r\n\t\t\tborder-radius: 10px 10px 0 0;\r\n\t\t\tmargin-top: -10px;\r\n\t\t\tposition: relative;\r\n\t\t\tz-index: 2;\r\n\t\t\toverflow: hidden;\r\n\r\n\t\t\t.infoModel {\r\n\t\t\t\tcolor: $text-font-color-1;\r\n\t\t\t\t@include flex-box();\r\n\t\t\t\theight: 50px;\r\n\t\t\t\tbackground: #fff;\r\n\t\t\t\tpadding: 0 30rpx;\r\n\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\tborder-bottom: 1px solid $border-color;\r\n\r\n\t\t\t\t.right {\r\n\t\t\t\t\t@include flex-box();\r\n\t\t\t\t\tcolor: $brand-theme-color-aux;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.scrollLayout {\r\n\t\t\t\theight: calc(100% - 100rpx);\r\n\t\t\t\t@include flex-box();\r\n\t\t\t\t// background-color: #bfa;\r\n\r\n\r\n\r\n\t\t\t\t.leftScroll {\r\n\t\t\t\t\theight: 100%;\r\n\t\t\t\t\twidth: 190rpx;\r\n\t\t\t\t\tborder-right: 1rpx solid $border-color;\r\n\t\t\t\t\tbackground: $page-bg-color;\r\n\r\n\t\t\t\t\t.navItem {\r\n\t\t\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\t\t\tpadding-left: 30rpx;\r\n\t\t\t\t\t\tline-height: 100rpx;\r\n\t\t\t\t\t\tcolor: $text-font-color-2;\r\n\t\t\t\t\t\tposition: relative;\r\n\r\n\t\t\t\t\t\t&.active {\r\n\t\t\t\t\t\t\tcolor: $text-font-color-1;\r\n\t\t\t\t\t\t\tbackground: #fff;\r\n\r\n\t\t\t\t\t\t\t&::after {\r\n\t\t\t\t\t\t\t\tcontent: \"\";\r\n\t\t\t\t\t\t\t\twidth: 6rpx;\r\n\t\t\t\t\t\t\t\theight: 30rpx;\r\n\t\t\t\t\t\t\t\tbackground: $brand-theme-color;\r\n\t\t\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\t\t\tleft: 0;\r\n\t\t\t\t\t\t\t\ttop: 50%;\r\n\t\t\t\t\t\t\t\ttransform: translateY(-50%);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.rightScroll {\r\n\t\t\t\t\theight: 100%;\r\n\t\t\t\t\tflex: 1;\r\n\t\t\t\t\tposition: relative;\r\n\r\n\t\t\t\t\t.searchView {\r\n\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\ttop: 0;\r\n\t\t\t\t\t\tright: 30rpx;\r\n\t\t\t\t\t\tz-index: 3;\r\n\t\t\t\t\t\t@include flex-box-set();\r\n\t\t\t\t\t\theight: 90rpx;\r\n\t\t\t\t\t\tcolor: $brand-theme-color-aux;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.productView {\r\n\t\t\t\t\t\tpadding: 0 30rpx;\r\n\r\n\t\t\t\t\t\t.proTitle {\r\n\t\t\t\t\t\t\tline-height: 90rpx;\r\n\t\t\t\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\t\t\t\tbackground: #fff;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.sContent {\r\n\t\t\t\t\theight: 100%;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/zmq/Documents/GitHub/personalStudyNotes/uniapp/xxmMall/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["useSystem","useCar","ref","onReady","uni"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAoEC,UAAM,cAAcA,aAAAA,UAAW;AAC/B,UAAM,WAAWC,UAAAA,OAAQ;AAEzB,QAAI,SAASC,cAAG,IAAC,CAAC;AAClB,QAAI,mBAAmBA,cAAG,IAAC,CAAC;AAC5B,QAAI,kBAAkBA,cAAG,IAAC,CAAC;AAC3B,QAAI,aAAaA,cAAG,IAAC,EAAE;AACvB,QAAI,cAAcA,cAAG,IAAC,EAAE;AACxB,QAAI,YAAYA,cAAG,IAAC,KAAK;AAEzB,QAAI,WAAWA,cAAAA,IAAI,CAAC;AAAA,MACnB,IAAI;AAAA,MACJ,MAAM;AAAA,MACN,UAAU,CAAC;AAAA,QACV,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,OAAO;AAAA,QACP,cAAc;AAAA,QACd,OAAO;AAAA,QACP,UAAU;AAAA,MACb,GAAK;AAAA,QACF,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,OAAO;AAAA,QACP,cAAc;AAAA,QACd,OAAO;AAAA,QACP,UAAU;AAAA,MACb,CAAG;AAAA,IACH,GAAI;AAAA,MACF,IAAI;AAAA,MACJ,MAAM;AAAA,MACN,UAAU,CAAC;AAAA,QACV,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,OAAO;AAAA,QACP,cAAc;AAAA,QACd,OAAO;AAAA,QACP,UAAU;AAAA,MACb,CAAG;AAAA,IACH,GAAI;AAAA,MACF,IAAI;AAAA,MACJ,MAAM;AAAA,MACN,UAAU,CAAC;AAAA,QACV,IAAI;AAAA,QACJ,MAAM;AAAA,QACN,OAAO;AAAA,QACP,cAAc;AAAA,QACd,OAAO;AAAA,QACP,UAAU;AAAA,MACb,CAAG;AAAA,IACH,CAAE,CAAC;AAIFC,kBAAAA,QAAQ,MAAM;AACb,mBAAc;AAAA,IAChB,CAAE;AAGD,aAAS,SAAS,OAAO;AAExB,UAAI,OAAO,SAAS;AAAO;AAC3B,UAAI;AACJ,UAAI,SAAS;AACZ,qBAAa,OAAO;AAAA,MACpB;AAED,gBAAU,WAAW,MAAM;AAE1B,eAAO,QAAQ;AAEf,yBAAiB,QAAQ,YAAY,MAAM,KAAK;AAEhD,wBAAgB,QAAQ,WAAW,MAAM,KAAK;AAAA,MAC9C,GAAE,GAAG;AAAA,IAGN;AAED,aAAS,eAAe;AACvB,UAAI,cAAcC,cAAG,MAAC,oBAAqB;AAC3C,UAAI,qBAAqB;AAGzB,kBAAY,OAAO,eAAe,EAAE,mBAAmB,UAAQ;AAC9D,6BAAqB,KAAK;AAAA,MAC1B,CAAA,EAAE,KAAM;AAGT,kBAAY,UAAU,UAAU,EAAE,mBAAmB,WAAS;AAE7D,mBAAW,QAAQ,MAAM,IAAI,UAAQ;AACpC,iBAAO,KAAK,MAAM,qBAAqB,KAAK;AAAA,QAChD,CAAI;AAAA,MACD,CAAA,EAAE,KAAM;AAGT,kBAAY,UAAU,cAAc,EAAE,mBAAmB,WAAS;AAEjE,oBAAY,QAAQ,MAAM,IAAI,UAAQ;AACrC,iBAAO,KAAK,MAAM,qBAAqB,KAAK;AAAA,QAChD,CAAI;AAAA,MACD,CAAA,EAAE,KAAM;AAAA,IAET;AAED,aAAS,eAAe,GAAG;AAE1B,UAAI,YAAY,KAAK,KAAK,EAAE,OAAO,SAAS;AAE5C,UAAI,MAAM,YAAY,MAAM,UAAU,CAAC,MAAM,OAAO,QAAQ;AAC3D,eAAO,aAAa,QAAQ,YAAY,IAAI,QAAQ,CAAC;AAAA,MACxD,CAAG;AACD,aAAO,QAAQ;AACf,sBAAgB,QAAQ,WAAW,MAAM,GAAG;AAE5C,UAAI,YAAY,KAAK;AACpB,oBAAY,aAAa,IAAI;AAAA,MAEhC,OAAS;AACN,oBAAY,aAAa,KAAK;AAAA,MAE9B;AAAA,IACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9LF,GAAG,WAAW,eAAe;"}